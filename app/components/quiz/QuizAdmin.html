<div class="container">
    <h1>Quiz Administration</h1>

    <form [ngFormModel]="form">
        <div class="input-group">
            <label>
                Question Category:
                <select class="catSelect" ngControl="category">
                    <option *ngFor="#c of categories | async" [value]="c">{{c}}</option>
                </select>
            </label>

            <label>
                Answer Category:
                <select class="catSelect" ngControl="answerCategory">
                    <option value="">(all)</option>
                    <option *ngFor="#ac of answerCategoryList" [value]="ac">{{ac}}</option>
                </select>
            </label>
        </div>
    </form>
    <h2>Click a category or answer to edit</h2>
    <table class="table table-condensed">
        <thead>
            <tr>
                <th>Id</th>
                <th>Question</th>
                <th>Answer Category</th>
                <th>Answer</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="#q of filteredQuestions | async">
                <td>{{q.questionId}}</td>
                <td>{{q.question}}</td>
                <td class="editable">
                    <span [ngClass]="getQuestionClass(q)" [hidden]="q.editingAnswerCategory" (click)="q.editingAnswerCategory = true">{{q.answerCategory}}</span>
                    <select [hidden]="!q.editingAnswerCategory || q.freeform" [(ngModel)]="q.answerCategory" (change)="q.editingAnswerCategory = false; q.changed = true">
                        <option *ngFor="#ac of answerCategoryList" [value]="ac">{{ac}}</option>
                    </select>
                    <input [hidden]="!q.editingAnswerCategory || q.freeform" type="button" value="+" (click)="q.freeform = true" />
                    <input [hidden]="!q.editingAnswerCategory || !q.freeform" [(ngModel)]="q.answerCategory" (blur)="q.editingAnswerCategory = false; q.changed = true" />
                </td>
                <td class="editable">
                    <span [ngClass]="getQuestionClass(q)" [hidden]="q.editingQuestion" (click)="q.editingQuestion = true">{{q.answer}}</span>
                    <input [hidden]="!q.editingQuestion" [(ngModel)]="q.answer" (blur)="q.editingQuestion = false; q.changed = true" />
                </td>
                <td>
                    <input type="button" value="Update" (click)="updateQuestion(q)" />
                </td>
            </tr>
        </tbody>
    </table>
</div>
